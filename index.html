<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WFW Linkchecker</title>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
  <style>
    body { margin: 0; font-family: "Segoe UI", sans-serif; background-color: #c7008d; color: #333; }
    .logo { text-align: center; margin-top: 30px; }
    .logo img { width: 100px; max-width: 30vw; }
    .lang-switch { text-align: center; margin: 10px; }
    .lang-switch button { background: none; border: none; font-size: 1rem; color: white; cursor: pointer; margin: 0 5px; text-decoration: underline; }
    .content-box { background: white; max-width: 700px; margin: 30px auto; padding: 20px; border-radius: 12px; box-shadow: 0 0 10px rgba(0,0,0,0.2); }
    h1 { text-align: center; color: #007acc; font-size: clamp(1.4rem, 5vw, 2rem); margin-bottom: 1rem; }
    p { font-size: 1rem; line-height: 1.6; }
    input, button { width: 100%; padding: 0.9rem; font-size: 1rem; margin-top: 1rem; border-radius: 6px; border: 1px solid #ccc; box-sizing: border-box; }
    button.check { background: #007acc; color: white; border: none; cursor: pointer; }
    .output, .explanation { margin-top: 1.5rem; padding: 1rem; border-radius: 6px; }
    .safe { background: #d4edda; color: #155724; }
    .warning { background: #fff3cd; color: #856404; }
    .danger { background: #f8d7da; color: #721c24; }
    .footer-link { display: block; text-align: center; color: white; text-decoration: none; margin: 30px auto 20px; font-weight: bold; font-size: 1rem; }
    #reader { width: 100%; max-width: 400px; margin: auto; display: none; }
  </style>
</head>
<body>
<div class="logo"><img src="WFW.jpg" alt="WFW Logo"></div>
<div class="lang-switch">
  <button onclick="setLang('de')">üá©üá™ Deutsch</button>
  <button onclick="setLang('en')">üá¨üáß English</button>
</div>
<div class="content-box">
  <h1 id="title">üîç Link-Checker ‚Äì Phishing erkennen</h1>
  <p id="desc">Pr√ºfe hier anonym & sicher, ob ein Link gef√§hrlich oder gef√§lscht ist:</p>
  <input type="text" id="urlInput" placeholder="https://example.com">
  <button class="check" onclick="checkUrl()" id="checkBtn">Pr√ºfen</button>
  <div style="text-align:center;">
    <button onclick="startQR()">üì∑ QR-Code scannen</button>
  </div>
  <div id="reader"></div>
  <div id="result" class="output"></div>
  <div id="explanation" class="explanation"></div>
  <div style="margin-top: 1.5rem; text-align: center;">
    <a href="https://w-f-w.at/hilfe-nach-dem-klick/" target="_blank" style="color: #007acc; font-weight: bold;">‚ùì Was tun, wenn ich draufgeklickt habe?</a>
  </div>
</div>
<a href="https://w-f-w.at" class="footer-link">üè† Zur√ºck zur Startseite</a>
<script>
const texts = {
  de: {
    title: "üîç Link-Checker ‚Äì Phishing erkennen",
    desc: "Pr√ºfe hier anonym & sicher, ob ein Link gef√§hrlich oder gef√§lscht ist:",
    checkBtn: "Pr√ºfen",
    explanation: {
      green: "‚úÖ Der Link scheint sicher zu sein.",
      yellow: "‚ö†Ô∏è Der Link sieht verd√§chtig aus. Bitte vorsichtig sein!",
      red: "üö´ Achtung! Dieser Link ist gef√§hrlich oder bekannt als Betrug."
    }
  },
  en: {
    title: "üîç Link Checker ‚Äì Detect Phishing",
    desc: "Check if a link is dangerous or suspicious ‚Äì anonymous & free:",
    checkBtn: "Check",
    explanation: {
      green: "‚úÖ The link appears to be safe.",
      yellow: "‚ö†Ô∏è The link looks suspicious. Be cautious!",
      red: "üö´ Warning! This link is dangerous or known for fraud."
    }
  }
};

let currentLang = 'de';
function setLang(lang) {
  currentLang = lang;
  document.getElementById('title').innerText = texts[lang].title;
  document.getElementById('desc').innerText = texts[lang].desc;
  document.getElementById('checkBtn').innerText = texts[lang].checkBtn;
}

const blacklist = [
  "banco-internet.ga", "sicher-login.top", "androidlink.cc", "win-promo.xyz", "lotto-gewinnspiel.cc"
];

async function checkUrl() {
  const url = document.getElementById("urlInput").value;
  const resultDiv = document.getElementById("result");
  const explanation = document.getElementById("explanation");
  resultDiv.innerHTML = "‚è≥ Wird gepr√ºft...";
  resultDiv.className = "output";
  explanation.innerHTML = "";

  try {
    const parsedUrl = new URL(url.includes("://") ? url : "http://" + url);
    const host = parsedUrl.hostname;

    if (blacklist.some(entry => host.includes(entry))) {
      resultDiv.innerHTML = texts[currentLang].explanation.red;
      resultDiv.classList.add("danger");
      return;
    }

    // Google Safe Browsing API (API-Key anpassen!)
    const googleResult = await fetch(`https://safebrowsing.googleapis.com/v4/threatMatches:find?key=AIzaSyA0HyrC4HxtnXd11ZkJvxPVT3Q-qAdHsDQ`, {
      method: "POST",
      body: JSON.stringify({
        client: { clientId: "wfw-checker", clientVersion: "1.0" },
        threatInfo: {
          threatTypes: ["MALWARE", "SOCIAL_ENGINEERING"],
          platformTypes: ["ANY_PLATFORM"],
          threatEntryTypes: ["URL"],
          threatEntries: [{ url }]
        }
      }),
      headers: { "Content-Type": "application/json" }
    });
    const threat = await googleResult.json();
    if (threat.matches) {
      resultDiv.innerHTML = texts[currentLang].explanation.red;
      resultDiv.classList.add("danger");
      return;
    }

    // Heuristik pr√ºfen
    const heuristics = [];
    if (url.includes("@")) heuristics.push("‚ö†Ô∏è Die URL enth√§lt ein '@'.");
    if ([".ga", ".tk", ".ml", ".gq", ".xyz", ".top", ".cf"].some(tld => host.endsWith(tld)))
      heuristics.push("‚ö†Ô∏è Verd√§chtige Domainendung.");
    if (host.length < 10) heuristics.push("‚ö†Ô∏è Sehr kurzer Domainname.");
    if (["android", "secure", "update", "login"].some(word => host.includes(word)))
      heuristics.push("‚ö†Ô∏è Domain enth√§lt verd√§chtige W√∂rter.");
    if (!url.startsWith("https://")) heuristics.push("‚ö†Ô∏è Keine HTTPS-Verbindung.");

    const heuristicWarnings = heuristics.map(w => `<li>${w}</li>`).join("");
    if (heuristics.length > 0) {
      resultDiv.innerHTML = texts[currentLang].explanation.yellow;
      resultDiv.classList.add("warning");
      explanation.innerHTML = "<ul>" + heuristicWarnings + "</ul>";
      return;
    }

    resultDiv.innerHTML = texts[currentLang].explanation.green;
    resultDiv.classList.add("safe");

  } catch {
    resultDiv.innerHTML = "‚ùå Ung√ºltige URL.";
    resultDiv.classList.add("warning");
  }
}

function startQR() {
  const readerDiv = document.getElementById("reader");
  readerDiv.style.display = "block";
  const qr = new Html5Qrcode("reader");
  qr.start({ facingMode: "environment" }, { fps: 10, qrbox: 250 }, (decodedText) => {
    document.getElementById("urlInput").value = decodedText;
    qr.stop().then(() => {
      readerDiv.style.display = "none";
      checkUrl();
    });
  }, console.warn);

  // ‚úÖ Jetzt mit kleinem Timeout
  setTimeout(() => {
    readerDiv.scrollIntoView({ behavior: "smooth", block: "center" });
  }, 300); // 300ms Verz√∂gerung reicht
}

</script>
</body>
</html>
